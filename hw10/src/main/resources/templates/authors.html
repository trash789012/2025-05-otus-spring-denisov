<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>List of all authors</title>
    <style th:replace="~{fragments/menu :: menu-styles}"></style>
    <style th:replace="~{fragments/styles :: table-styles}"></style>
    <style th:replace="~{fragments/styles :: global-styles}"></style>

</head>
<body>

<!-- menu -->
<div class="nav-container">
    <div class="nav-menu" th:replace="~{fragments/menu :: main-menu}"></div>
</div>

<div class="content-container">
    <div class="table-header">
        <h2>List of authors</h2>
        <a th:href="@{/author/new}" class="create-button-action">new</a>
    </div>

    <table class="authors">
        <thead>
        <tr>
            <th>Author name</th>
            <th>Action</th>
        </tr>
        </thead>
        <tbody id="authors-table-body">
        <!-- insert from JS code -->
        </tbody>
    </table>
</div>

<script type="module" src="../static/js/authors.js" th:src="@{/js/authors.js}"></script>

<script>

    // document.addEventListener('DOMContentLoaded', function () {
    //
    //     //грузим авторов
    //     loadAuthors();
    //
    //     function loadAuthors() {
    //         fetch('/api/v1/author')
    //             .then(response => {
    //                 if (!response.ok) {
    //                     throw new Error("Network response was not ok!")
    //                 }
    //                 return response.json();
    //             })
    //             .then(authors => {
    //                 const tableBody = document.getElementById("authors-table-body");
    //                 tableBody.innerHTML = '';
    //
    //                 authors.forEach(author => {
    //                     const row = document.createElement('tr');
    //
    //                     // Колонка с именем автора
    //                     const nameCell = document.createElement('td');
    //                     const nameLink = document.createElement('a');
    //                     nameLink.href = `/author/${author.id}`;
    //                     nameLink.textContent = author.fullName;
    //                     nameCell.appendChild(nameLink);
    //
    //                     // Колонка с действиями
    //                     const actionCell = document.createElement('td');
    //                     const deleteButton = document.createElement('button');
    //                     deleteButton.textContent = 'Delete';
    //                     deleteButton.className = 'btn-link';
    //                     deleteButton.onclick = () =>  {
    //                         deleteAuthor(author.id);
    //                     }
    //                     actionCell.appendChild(deleteButton);
    //
    //                     row.appendChild(nameCell);
    //                     row.appendChild(actionCell);
    //                     tableBody.appendChild(row);
    //                 });
    //             })
    //             .catch(error => {
    //                 console.error('Error loading authors', error);
    //                 alert('Failed to load authors')
    //             })
    //     }
    //
    //     function deleteAuthor(authorId) {
    //         if (!confirm('Are you sure you want to delete this author?')) {
    //             return;
    //         }
    //
    //         fetch(`/api/v1/author/${authorId}`, {
    //             method: 'DELETE',
    //             headers: {
    //                 'Accept': 'application/json',
    //                 'Content-Type': 'application/json'
    //             }
    //         })
    //             .then(response => {
    //                 if (response.ok) {
    //                     loadAuthors(); // Обновляем список после удаления
    //                 } else {
    //                     throw new Error('Delete failed');
    //                 }
    //             })
    //             .catch(error => {
    //                 console.error('Error deleting author:', error);
    //                 alert('Filed to delete author');
    //             })
    //     }
    //
    // })
</script>

</body>
</html>
